
 Http Headers
----------------------

Probleem:
  Content en Headers versturen.

Huidige oplossing:
  door de isWrappable() functie wordt bepaald in het Website object of het component de wrapComponent() functie ingaat.
  Deze aanpak is niet flexibel

Nieuwe flow:


VirtualFolder en Command blijven hetzelfde, maar de functie execute() wordt hernoemd naar generateContent();
Een Website class krijgt ook nog een extra generateDocument() functie.
(Deze vervangt de initDocument en render)

getDocument() blijft (voor styling, <title>, enz), maar de headers eigenschap wordt anders.


een document krijgt een getHeaders() functie.

De componenten vormen een tree.

 Document
 |- Layout Template
    |- Menu
    |- Content

Een component *mag* een getHeaders() functie hebben.
Als een component deze functie implementeerd zal deze een header array returnen.

Als een component subcomponenten bevat, moet deze de getHeaders implementeren en alle subcomponenten controleren of deze een getHeaders() bevatten.

Deze wordt dan samengevoegd tot de uiteindelijke lijst met headers.
Des te lager in de tree, des te meer voorang de header.


Hmm wanneer worden er headers aangepast? alleen bij stand-alone(Json, Image, File) of ook door geneste componenten?
bijde, met name de statuscode (404 500) wordt aangepast.


Design decisions:
  headers horen bij de view.
  HttpError wordt een compontent.

I.p.v. een isWrappable() wordt er gekeken of ge-extend wordt van de Document class?
(Hierdoor krijgt de gd library een depenancy van mvc)
Maar als er een website in een website getoond moet worden geeft dit dan problemen?
Nee, dat kan als de static getDocument() functie gebruikt wordt.

Step1 (done)
* Refactor Website to generateDocument() en generateContent()
* Website is geen Component meer, maar een controller

Step 2
De rol van de Document class wegwerken, deze rol*1 naar Website verplaatsen.

*1 HTTP header & content versturen naar de browser. Het document opslaan functie verplaatsen naar een nieuwe class?

HtmlDocument wordt een Component, deze vult m.b.v. de getHeaders() de <head> van de template.
Stylesheets zullen nu op de Layout template gezet worden.

Issue: Je weet van te voren niet of de output in een layout gezet moet worden.
mogelijke functienamen: isMasterPage(),  isWrappable(), isContent(), isDocument()

Issue: Voordat de render() aangeroepen wordt dient de getHeaders() slecht 1x aangeroepen te worden.
Op verschillende stadia zijn de header gegevens nodig.

Step 3
Issue: active charset (default instellen op utf8)
Kan niet meer via getDocument()


